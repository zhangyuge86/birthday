<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<title>王灿生日快乐</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
body{margin:0;font-family:"Segoe UI",sans-serif;background:radial-gradient(circle at top,#1b2a4d,#090b1a);color:#fff;min-height:100vh;display:flex;flex-direction:column;align-items:center;text-align:center;gap:32px;padding:48px 16px}
h1{margin:0;font-size:clamp(2.4rem,5vw,3rem)}
p{margin:0;font-size:1.1rem;max-width:520px;line-height:1.6}
main{display:flex;flex-direction:column;align-items:center;gap:32px;width:100%;max-width:640px}
.countdown{display:flex;flex-wrap:wrap;gap:12px;justify-content:center;font-size:1.2rem}
.countdown span{background:rgba(255,255,255,0.12);padding:12px 18px;border-radius:14px;min-width:90px;font-weight:600}
button{background:#ff8a65;border:none;color:#fff;padding:12px 28px;border-radius:999px;font-size:1rem;cursor:pointer;transition:transform .2s}
button:hover{transform:translateY(-2px)}
form{display:flex;flex-direction:column;gap:12px;width:100%;max-width:420px}
input,textarea{width:100%;padding:12px 14px;border-radius:12px;border:none;font-size:1rem}
.messages{width:100%;max-width:420px;display:flex;flex-direction:column;gap:12px}
.message-card{background:rgba(255,255,255,0.12);padding:16px;border-radius:16px;text-align:left}
.message-card strong{display:block;margin-bottom:6px}
footer{font-size:.9rem;color:rgba(255,255,255,0.7)}
audio{display:none}
</style>
</head>
<body>
<h1>来自周口的王灿，生日快乐</h1>
<p>农历九月十三再相聚，先把最真诚的祝福留在这里，让银河为你照亮。</p>
<main>
<div class="countdown" id="countdown"></div>
<button id="musicBtn">播放生日歌</button>
<form id="wishForm">
<input id="nameInput" type="text" placeholder="你的名字" required />
<textarea id="wishInput" rows="3" placeholder="写下祝福" required></textarea>
<button type="submit">发送祝福</button>
</form>
<div class="messages" id="messages"></div>
</main>
<footer>愿你岁岁安康，前程似锦</footer>
<audio id="bgm" src="https://cdn.pixabay.com/download/audio/2022/09/29/audio_9b4f9c8763.mp3?filename=best-friends-122689.mp3" preload="auto"></audio>
<script>
const countdownEl=document.getElementById("countdown");
const musicBtn=document.getElementById("musicBtn");
const audio=document.getElementById("bgm");
const form=document.getElementById("wishForm");
const nameInput=document.getElementById("nameInput");
const wishInput=document.getElementById("wishInput");
const messagesEl=document.getElementById("messages");
const wishKey="wangcan_wishes_v1";
const target=new Date("2025-10-13T00:00:00+08:00");
function pad(n){return n.toString().padStart(2,"0");}
function renderCountdown(){
  const now=new Date();
  let diff=target-now;
  if(diff<0){diff=0;}
  const days=Math.floor(diff/86400000);
  const hours=Math.floor(diff%86400000/3600000);
  const minutes=Math.floor(diff%3600000/60000);
  const seconds=Math.floor(diff%60000/1000);
  countdownEl.innerHTML=[
    ["天",pad(days)],
    ["时",pad(hours)],
    ["分",pad(minutes)],
    ["秒",pad(seconds)]
  ].map(([unit,value])=>`<span>${value}<br>${unit}</span>`).join("");
}
renderCountdown();
setInterval(renderCountdown,1000);
let playing=false;
musicBtn.addEventListener("click",async()=>{
  try{
    if(!playing){
      await audio.play();
      musicBtn.textContent="暂停生日歌";
      playing=true;
    }else{
      audio.pause();
      musicBtn.textContent="播放生日歌";
      playing=false;
    }
  }catch(err){console.warn(err);}
});
function loadWishes(){
  try{return JSON.parse(localStorage.getItem(wishKey)||"[]");}
  catch(err){return [];}
}
function saveWishes(list){
  localStorage.setItem(wishKey,JSON.stringify(list.slice(0,20)));
}
function renderWishes(){
  const list=loadWishes();
  messagesEl.innerHTML=list.map(item=>`<div class="message-card"><strong>${item.name}</strong><p>${item.text}</p><small>${item.time}</small></div>`).join("");
}
form.addEventListener("submit",event=>{
  event.preventDefault();
  const name=nameInput.value.trim();
  const text=wishInput.value.trim();
  if(!name||!text)return;
  const now=new Date();
  const wish={
    name,
    text,
    time:`${now.getFullYear()}-${pad(now.getMonth()+1)}-${pad(now.getDate())} ${pad(now.getHours())}:${pad(now.getMinutes())}`
  };
  const list=[wish,...loadWishes()];
  saveWishes(list);
  renderWishes();
  form.reset();
});
renderWishes();
</script>
</body>
</html>
